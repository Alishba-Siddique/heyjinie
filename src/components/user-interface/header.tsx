// src/components/header/header.tsx

'use client';
import React from 'react';
import { useCart } from '@/context/CartContext';
import { FiShoppingCart } from 'react-icons/fi';
// import { PiSignOutBold } from 'react-icons/pi';
import { FaRegUserCircle } from 'react-icons/fa';
import { useRouter } from 'next/navigation';
import withAuth from '@/hoc/withAuth';
import { clearSession } from '../../utils/sessionUtility';
import { toast } from 'react-toastify';

const Header = () => {
  const router = useRouter();
  const { cartCount } = useCart();

  const handleLogout = () => {
    clearSession();
    toast.success('Logged out successfully!');
    router.push('/auth');
  };

  const handleCartClick = () => {
    router.push('/cart');
  };

  const handleProfileClick = () => {
    router.push('/profile');
  };

  return (
    <header className="at-header">
      <div className="at-headerleft">
        <span>
          <svg
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M6.875 3.75V16.25H3.125C2.95924 16.25 2.80027 16.1842 2.68306 16.0669C2.56585 15.9497 2.5 15.7908 2.5 15.625V4.375C2.5 4.20924 2.56585 4.05027 2.68306 3.93306C2.80027 3.81585 2.95924 3.75 3.125 3.75H6.875Z"
              fill="black"
              fillOpacity="0.04"
            />
            <path
              d="M16.875 3.125H3.125C2.79348 3.125 2.47554 3.2567 2.24112 3.49112C2.0067 3.72554 1.875 4.04348 1.875 4.375V15.625C1.875 15.9565 2.0067 16.2745 2.24112 16.5089C2.47554 16.7433 2.79348 16.875 3.125 16.875H16.875C17.2065 16.875 17.5245 16.7433 17.7589 16.5089C17.9933 16.2745 18.125 15.9565 18.125 15.625V4.375C18.125 4.04348 17.9933 3.72554 17.7589 3.49112C17.5245 3.2567 17.2065 3.125 16.875 3.125ZM3.125 11.875H4.375C4.54076 11.875 4.69973 11.8092 4.81694 11.6919C4.93415 11.5747 5 11.4158 5 11.25C5 11.0842 4.93415 10.9253 4.81694 10.8081C4.69973 10.6908 4.54076 10.625 4.375 10.625H3.125V9.375H4.375C4.54076 9.375 4.69973 9.30915 4.81694 9.19194C4.93415 9.07473 5 8.91576 5 8.75C5 8.58424 4.93415 8.42527 4.81694 8.30806C4.69973 8.19085 4.54076 8.125 4.375 8.125H3.125V6.875H4.375C4.54076 6.875 4.69973 6.80915 4.81694 6.69194C4.93415 6.57473 5 6.41576 5 6.25C5 6.08424 4.93415 5.92527 4.81694 5.80806C4.69973 5.69085 4.54076 5.625 4.375 5.625H3.125V4.375H6.25V15.625H3.125V11.875ZM16.875 15.625H7.5V4.375H16.875V15.625Z"
              fill="black"
            />
          </svg>
        </span>
        <h2>Dashboard</h2>
      </div>
      <div className="at-headerright">
        <div className="at-headersearch">
          <form>
            <fieldset>
              <div className="at-inputsearch">
                <span>
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M14.35 14.3562C14.2567 14.4482 14.131 14.4998 14 14.5C13.8672 14.4994 13.7397 14.448 13.6438 14.3562L10.9438 11.65C9.80662 12.6051 8.34465 13.0844 6.86276 12.9878C5.38086 12.8912 3.99346 12.2263 2.98991 11.1316C1.98636 10.037 1.44415 8.5972 1.47636 7.1125C1.50858 5.62782 2.11272 4.21288 3.1628 3.1628C4.21289 2.11272 5.62782 1.50857 7.11251 1.47636C8.5972 1.44414 10.037 1.98635 11.1316 2.9899C12.2263 3.99345 12.8912 5.38085 12.9878 6.86275C13.0844 8.34465 12.6051 9.80661 11.65 10.9437L14.35 13.6437C14.3972 13.6903 14.4348 13.7457 14.4604 13.8069C14.486 13.8681 14.4992 13.9337 14.4992 14C14.4992 14.0663 14.486 14.1319 14.4604 14.1931C14.4348 14.2543 14.3972 14.3097 14.35 14.3562ZM7.25001 12C8.18947 12 9.10783 11.7214 9.88896 11.1995C10.6701 10.6775 11.2789 9.93569 11.6384 9.06774C11.9979 8.1998 12.092 7.24473 11.9087 6.32332C11.7255 5.40191 11.2731 4.55554 10.6088 3.89124C9.94446 3.22694 9.09809 2.77455 8.17668 2.59127C7.25527 2.40799 6.30021 2.50205 5.43226 2.86157C4.56431 3.22109 3.82246 3.82991 3.30052 4.61104C2.77859 5.39217 2.50001 6.31054 2.50001 7.25C2.50166 8.50927 3.00264 9.71649 3.89307 10.6069C4.78351 11.4974 5.99073 11.9983 7.25001 12Z"
                      fill="black"
                      fillOpacity="0.4"
                    />
                  </svg>
                </span>
                <input type="text" placeholder="Search" />
                <span>
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M3.84801 15.2287C3.4536 15.2287 3.09233 15.1326 2.7642 14.9403C2.43608 14.7448 2.17424 14.483 1.97869 14.1548C1.78646 13.8267 1.69034 13.4654 1.69034 13.071C1.69034 12.6733 1.78646 12.3104 1.97869 11.9822C2.17424 11.6541 2.43608 11.3923 2.7642 11.1967C3.09233 11.0012 3.4536 10.9034 3.84801 10.9034H5.00142V8.90483H3.84801C3.4536 8.90483 3.09233 8.80871 2.7642 8.61648C2.43608 8.42093 2.17424 8.16075 1.97869 7.83594C1.78646 7.50781 1.69034 7.14489 1.69034 6.74716C1.69034 6.34943 1.78646 5.98816 1.97869 5.66335C2.17424 5.33523 2.43608 5.07505 2.7642 4.88281C3.09233 4.68726 3.4536 4.58949 3.84801 4.58949C4.24574 4.58949 4.60866 4.68726 4.93679 4.88281C5.26491 5.07505 5.52675 5.33523 5.7223 5.66335C5.91785 5.98816 6.01562 6.34943 6.01562 6.74716V7.89062H8.0142V6.74716C8.0142 6.34943 8.11032 5.98816 8.30256 5.66335C8.49811 5.33523 8.75829 5.07505 9.0831 4.88281C9.41122 4.68726 9.77415 4.58949 10.1719 4.58949C10.5696 4.58949 10.9309 4.68726 11.2557 4.88281C11.5838 5.07505 11.844 5.33523 12.0362 5.66335C12.2318 5.98816 12.3295 6.34943 12.3295 6.74716C12.3295 7.14489 12.2318 7.50781 12.0362 7.83594C11.844 8.16075 11.5838 8.42093 11.2557 8.61648C10.9309 8.80871 10.5696 8.90483 10.1719 8.90483H9.02841V10.9034H10.1719C10.5696 10.9034 10.9309 11.0012 11.2557 11.1967C11.5838 11.3923 11.844 11.6541 12.0362 11.9822C12.2318 12.3104 12.3295 12.6733 12.3295 13.071C12.3295 13.4654 12.2318 13.8267 12.0362 14.1548C11.844 14.483 11.5838 14.7448 11.2557 14.9403C10.9309 15.1326 10.5696 15.2287 10.1719 15.2287C9.77415 15.2287 9.41122 15.1326 9.0831 14.9403C8.75829 14.7448 8.49811 14.483 8.30256 14.1548C8.11032 13.8267 8.0142 13.4654 8.0142 13.071V11.9176H6.01562V13.071C6.01562 13.4654 5.91785 13.8267 5.7223 14.1548C5.52675 14.483 5.26491 14.7448 4.93679 14.9403C4.60866 15.1326 4.24574 15.2287 3.84801 15.2287ZM3.84801 14.2145C4.06013 14.2145 4.25237 14.1631 4.42472 14.0604C4.60038 13.9576 4.73958 13.8201 4.84233 13.6477C4.94839 13.4721 5.00142 13.2798 5.00142 13.071V11.9176H3.84801C3.6392 11.9176 3.44697 11.9706 3.27131 12.0767C3.09896 12.1795 2.96141 12.3187 2.85866 12.4943C2.75592 12.6667 2.70455 12.8589 2.70455 13.071C2.70455 13.2798 2.75592 13.4721 2.85866 13.6477C2.96141 13.8201 3.09896 13.9576 3.27131 14.0604C3.44697 14.1631 3.6392 14.2145 3.84801 14.2145ZM3.84801 7.89062H5.00142V6.74716C5.00142 6.53504 4.94839 6.3428 4.84233 6.17045C4.73958 5.99811 4.60038 5.86056 4.42472 5.75781C4.25237 5.65507 4.06013 5.60369 3.84801 5.60369C3.6392 5.60369 3.44697 5.65507 3.27131 5.75781C3.09896 5.86056 2.96141 5.99811 2.85866 6.17045C2.75592 6.3428 2.70455 6.53504 2.70455 6.74716C2.70455 6.95928 2.75592 7.15317 2.85866 7.32883C2.96141 7.50118 3.09896 7.63873 3.27131 7.74148C3.44697 7.84091 3.6392 7.89062 3.84801 7.89062ZM9.02841 7.89062H10.1719C10.384 7.89062 10.5762 7.84091 10.7486 7.74148C10.9209 7.63873 11.0585 7.50118 11.1612 7.32883C11.264 7.15317 11.3153 6.95928 11.3153 6.74716C11.3153 6.53504 11.264 6.3428 11.1612 6.17045C11.0585 5.99811 10.9209 5.86056 10.7486 5.75781C10.5762 5.65507 10.384 5.60369 10.1719 5.60369C9.95975 5.60369 9.76586 5.65507 9.5902 5.75781C9.41785 5.86056 9.2803 5.99811 9.17756 6.17045C9.07813 6.3428 9.02841 6.53504 9.02841 6.74716V7.89062ZM10.1719 14.2145C10.384 14.2145 10.5762 14.1631 10.7486 14.0604C10.9209 13.9576 11.0585 13.8201 11.1612 13.6477C11.264 13.4721 11.3153 13.2798 11.3153 13.071C11.3153 12.8589 11.264 12.6667 11.1612 12.4943C11.0585 12.3187 10.9209 12.1795 10.7486 12.0767C10.5762 11.9706 10.384 11.9176 10.1719 11.9176H9.02841V13.071C9.02841 13.2798 9.07813 13.4721 9.17756 13.6477C9.2803 13.8201 9.41785 13.9576 9.5902 14.0604C9.76586 14.1631 9.95975 14.2145 10.1719 14.2145ZM6.01562 10.9034H8.0142V8.90483H6.01562V10.9034ZM18.687 4.34091L15.4057 16.5312H14.3319L17.6131 4.34091H18.687Z"
                      fill="black"
                      fillOpacity="0.4"
                    />
                  </svg>
                </span>
              </div>
            </fieldset>
          </form>
        </div>
        <div className="at-profilearea">
          <div className="flex justify-between items-center gap-4">
            <button
              className="at-headerbtn at-cartbtn"
              onClick={handleCartClick}
              aria-label="Cart"
            >
              {cartCount > 0 && (
                <span className="at-cartcount">{cartCount}</span>
              )}
              <FiShoppingCart />
            </button>
            <button
              className="at-headerbtn at-cartbtn"
              onClick={handleProfileClick}
            >
              <FaRegUserCircle />
            </button>
            {/* <button
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                handleLogout();
              }}
              className="bg-red-500 text-white rounded-lg px-4 py-2 at-btnlogoutholder flex items-center gap-2 at-headerbtn"
            >
              <PiSignOutBold />
              Logout
            </button> */}
          </div>
        </div>
      </div>
    </header>
  );
};

export default withAuth(Header);
